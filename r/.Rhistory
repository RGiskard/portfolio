getArtists("http://www.rock.com.ar/bios/pornombre/A.shtml")
getArtists(urls2scrap)
lapply(urls2scrap, getArtists)
ll <- lapply(urls2scrap, getArtists)
str(ll)
do.call(c, ll)
artists <- do.call(c, ll)
tail(artists)
aux <- gsub(",\\s(.*)", "", artists)
gsub(",\\s(.*)", "", artists)
gsub("(.*),\\s(.*)", "\\1", artists)
gsub("(.*),\\s(.*)", "\\2", artists)
article <- gsub("(.*),\\s(.*)", "\\2", artists)
idx <- article == artists
table(idx)
artists
artists.clean <- gsub("(.*),\\s(.*)", "\\1", artists)
artists.clean
article
idx <- article == artists.clean
table(artists.clean)
table(idx)
aux <- article[idx]
aux
aux <- article[!idx]
aux
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_text()
html_attr("a")
artist.name
}
ll <- lapply(urls2scrap, getArtists)
artists <- do.call(c, ll)
artists
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_text() %>%
html_attr("a")
artist.name
}
ll <- lapply(urls2scrap, getArtists)
artists <- do.call(c, ll)
artists
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
artist.name
}
ll <- lapply(urls2scrap, getArtists)
artists <- do.call(c, ll)
artists
getArtistsUrl("http://www.rock.com.ar/bios/pornombre/D.shtml")
website <- "http://www.rock.com.ar"
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.url <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
paste(website, artist.url)
}
getArtistsUrl("http://www.rock.com.ar/bios/pornombre/D.shtml")
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.url <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
paste(website, artist.url, sep = "")
}
getArtistsUrl("http://www.rock.com.ar/bios/pornombre/D.shtml")
ll <- lapply(urls2scrap, getArtistsUrl)
artists <- do.call(c, ll)
letters.url <- paste("http://www.rock.com.ar/bios/pornombre/", LETTERS, ".shtml", sep  = "")
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
artist.url <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
paste(website, artist.url, sep = "")
}
ll <- lapply(letters.url, getArtistsUrl)
artists.url <- do.call(c, ll)
length(artists.url)
?grepl
grepl("artistas", artists.url)
idx <- grepl("artistas", artists.url)
artists.url[idx]
main.artists.url <- artists.url[idx]
getArtistsUrl <- function(url) {
url.parsed <- read_html(url)
page.urls <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
paste(website, page.urls, sep = "")
}
getAlbumsUrl <- function(url) {
url.parsed <- read_html(url)
page.urls <- url.parsed %>%
html_nodes("br+ .clearfix div a") %>%
html_attr("href")
paste(website, page.urls, sep = "")
}
link <- "http://www.rock.com.ar/discos/0/882.shtml"
seq(1,10)
urls <- paste("http://www.rock.com.ar/letras/", num1, "/", num2, ".shtml", sep = "")
num1 <- seq(1, 10)
num2 <- seq(1, 1000)
urls <- paste("http://www.rock.com.ar/letras/", num1, "/", num2, ".shtml", sep = "")
urls
library(RCurl)
url.exists("http://google.com")
url.exists("http://www.rock.com.ar/letras/10/1000.shtml")
num1 <- seq(1, 100)
num2 <- seq(1, 30000)
urls <- paste("http://www.rock.com.ar/letras/", num1, "/", num2, ".shtml", sep = "")
setwd("D:/Google Drive/portfolio/r")
library(rvest)
library(RCurl)
website <- "http://www.rock.com.ar"
letters.url <- paste("http://www.rock.com.ar/bios/pornombre/", LETTERS, ".shtml", sep  = "")
?url.exists
lapply(letters.url, url.exists)
aux <- lapply(letters.url, url.exists)
aux
str(aux)
unlist(aux)
checkStatuslinks <- function(urls) {
idx <- unlist(lapply(urls, url.exists))
urls[idx]
}
length(letters.url)
letters.url %>% checkStatuslinks()
letters.url <- checkStatuslinks(letters.url)
getArtistsUrls <- function(url) {
url.parsed <- read_html(url)
artists.urls <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
artists.urls <- paste(website, artists.urls, sep = "")
idx <- grepl("artistas", artists.url)
main.artists.url <- artists.url[idx]
main.artists.url
}
ll <- lapply(letters.url, getArtistsUrls)
artists.url <- do.call(c, ll)
getArtistName <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("#contenedor h1") %>%
html_text()
artist.name
}
getAlbumsUrls <- function(url) {
url.parsed <- read_html(url)
albums.urls <- url.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
unique(albums.urls[grepl("/discos", albums.urls)])
}
ll2 <- lapply(main.artists.url, getAlbumsUrl)
ll2 <- lapply(main.artists.url, getAlbumsUrls)
ll <- lapply(letters.url, getArtistsUrls)
getArtistsUrls <- function(url) {
url.parsed <- read_html(url)
artists.urls <- url.parsed %>%
html_nodes(".clearfix a") %>%
html_attr("href")
artists.urls <- paste(website, artists.urls, sep = "")
idx <- grepl("artistas", artists.urls)
main.artists.urls <- artists.urls[idx]
main.artists.urls
}
ll <- lapply(letters.url, getArtistsUrls)
artists.url <- do.call(c, ll)
artists.urls <- do.call(c, ll)
length(artists.urls)
aux <- checkStatuslinks(artists.urls)
length(aux)
getAlbumsUrls <- function(url) {
url.parsed <- read_html(url)
albums.urls <- url.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
unique(albums.urls[grepl("/discos", albums.urls)])
}
ll2 <- lapply(artists.urls, getAlbumsUrls)
albums.urls <- do.call(c, ll2)
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
albums.urls
length(albums.urls)
aux <- checkStatuslinks(albums.urls)
length(aux)
albums.urls <- aux
getAlbumInfo <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- url.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- url.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.names <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_text() %>%
iconv(to = "latin1")
songs.urls <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
lyrics <- vector()
for(song in songs.urls) {
lyric <- getLyrics(song)
lyrics <- c(lyrics, lyric)
}
df <- data.frame(artist = artist.name, album = album.name,
year = year, songs = songs.names,
lyrics = lyrics, stringsAsFactors = FALSE)
df
}
ll3 <- lapply(albums.urls, getAlbumInfo)
getLyrics <- function(url) {
url.parsed <- read_html(url)
lyrics <- url.parsed %>%
html_nodes("p") %>%
html_text() %>%
iconv(to = "latin1")
lyrics
}
getAlbumInfo <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- url.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- url.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.names <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_text() %>%
iconv(to = "latin1")
songs.urls <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
lyrics <- vector()
for(song in songs.urls) {
lyric <- getLyrics(song)
lyrics <- c(lyrics, lyric)
}
df <- data.frame(artist = artist.name, album = album.name,
year = year, songs = songs.names,
lyrics = lyrics, stringsAsFactors = FALSE)
df
}
getAlbumInfo("http://www.rock.com.ar/discos/5/5133.shtml")
aux <- getAlbumInfo("http://www.rock.com.ar/discos/5/5133.shtml")
View(aux)
getLyrics <- function(url) {
url.parsed <- read_html(url)
lyrics <- url.parsed %>%
html_nodes("p") %>%
html_text()
lyrics
}
getAlbumInfo <- function(url) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- url.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- url.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.names <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_text()
songs.urls <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
lyrics <- vector()
for(song in songs.urls) {
lyric <- getLyrics(song)
lyrics <- c(lyrics, lyric)
}
df <- data.frame(artist = artist.name, album = album.name,
year = year, song.name = songs.names,
lyrics = lyrics, stringsAsFactors = FALSE)
df
}
aux <- getAlbumInfo("http://www.rock.com.ar/discos/5/5133.shtml")
View(aux)
all.dfs <- lapply(albums.urls, getAlbumInfo)
getLyrics <- function(url) {
if(url.exists(url)) {
url.parsed <- read_html(url)
lyrics <- url.parsed %>%
html_nodes("p") %>%
html_text()
lyrics
}
}
getAlbumInfo <- function(url) {
if(url.exists(url)) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- url.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- url.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.names <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_text()
songs.urls <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
lyrics <- vector()
for(song in songs.urls) {
lyric <- getLyrics(song)
lyrics <- c(lyrics, lyric)
}
df <- data.frame(artist = artist.name, album = album.name,
year = year, song.name = songs.names,
lyrics = lyrics, stringsAsFactors = FALSE)
df
}
}
all.dfs <- lapply(albums.urls, getAlbumInfo)
getLyrics <- function(url) {
url.parsed <- read_html(url)
lyrics <- url.parsed %>%
html_nodes("p") %>%
html_text()
lyrics
}
all.dfs <- lapply(albums.urls, getAlbumInfo)
for(artist.url in artists.urls[1:10]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
albums.urls
}
for(artist.url in artists.urls[1:10]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
print(albums.urls)
}
for(artist.url in artists.urls[1]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
print(albums.urls)
}
for(artist.url in artists.urls[1]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
albums.urls <- unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
print(albums.urls)
}
for(artist.url in artists.urls[1]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
albums.urls <- unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
albums.urls <- checkStatuslinks(albums.urls)
for(album.url in albums.urls) {
album.parsed <- read_html(album.url)
artist.name <- album.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- album.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- album.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.urls <- album.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
songs.urls <- checkStatuslinks(songs.urls)
lyrics <- vector()
for(song in songs.urls) {
url.parsed <- read_html(url)
lyric <- url.parsed %>%
html_nodes("p") %>%
html_text()
songs.names <- album.parsed %>%
html_nodes(".nombre-letra") %>%
html_text()
songs.names
}
}
}
for(artist.url in artists.urls[1]) {
artist.parsed <- read_html(artist.url)
albums.urls <- artist.parsed %>%
html_nodes("#contenedor a") %>%
html_attr("href")
albums.urls <- unique(albums.urls[grepl("/discos", albums.urls)])
albums.urls <- gsub("http://www.rock.com.ar", "", albums.urls)
albums.urls <- paste("http://www.rock.com.ar", albums.urls, sep = "")
albums.urls <- checkStatuslinks(albums.urls)
for(album.url in albums.urls) {
album.parsed <- read_html(album.url)
artist.name <- album.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- album.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- album.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.urls <- album.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
songs.urls <- checkStatuslinks(songs.urls)
for(song in songs.urls) {
url.parsed <- read_html(url)
lyric <- url.parsed %>%
html_nodes("p") %>%
html_text()
songs.names <- album.parsed %>%
html_nodes(".nombre-letra") %>%
html_text()
print(songs.names)
}
}
}
getAlbumInfo <- function(url) {
if(url.exists(url)) {
url.parsed <- read_html(url)
artist.name <- url.parsed %>%
html_nodes("a+ a") %>%
html_text() %>%
iconv(to = "latin1")
year <- url.parsed %>%
html_nodes(".anio") %>%
html_text()
album.name <- url.parsed %>%
html_nodes(".subtitle") %>%
html_text()
songs.names <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_text()
songs.urls <- url.parsed %>%
html_nodes(".nombre-letra") %>%
html_attr("href")
songs.urls <- paste(website, songs.urls, sep = "")
df <- data.frame(artist = artist.name, album = album.name,
year = year, song.name = songs.names,
lyric.url = songs.urls, stringsAsFactors = FALSE)
df
}
}
all.dfs <- lapply(albums.urls, getAlbumInfo)
df <- do.call(all.dfs, rbind)
str(all.dfs)
df <- do.call(all.dfs, rbind)
unlist(df)
str(all.dfs)
df <- lapply(all.dfs, rbind)
str(df)
df <- lapply(all.dfs, as.data.frame)
